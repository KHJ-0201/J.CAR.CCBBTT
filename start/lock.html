<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>보안 인증</title>
    <link rel="stylesheet" href="../index.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* [핵심 복구] index.css의 디자인을 방해하지 않도록 최소한의 배선만 추가합니다. */
        
        /* 1. 외부 브라우저 안내 바: 디자인을 해치지 않는 아주 얇은 텍스트 형태 */
        .external-link-section {
            display: none; 
            width: 100%;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px; /* 인증창 제목과의 간격 */
        }
        
        .external-btn-text {
            background: none !important;
            border: none !important;
            color: #64748b !important; /* 차분한 회색조 */
            font-size: 12px !important;
            text-decoration: underline; /* 클릭 가능한 링크 느낌 */
            cursor: pointer;
            font-weight: 600;
        }

        /* 2. 모바일에서 index.css의 거대한 설정을 억제하고 '두 번째 사진'처럼 돌려놓는 가드레일 */
        @media (max-width: 768px) {
            .auth-modal {
                min-height: auto !important; /* 웅장한 높이 대신 적절한 높이로 복구 */
                padding: 30px 20px !important;
                border-radius: 25px !important;
            }
            .auth-modal h2 { font-size: 1.5rem !important; margin-top: 5px !important; }
            .auth-modal p { font-size: 0.9rem !important; margin-bottom: 15px !important; }
            
            /* 입력창과 버튼을 두 번째 사진처럼 정상 크기로 복구 */
            .auth-modal input { 
                height: 45px !important; 
                font-size: 1rem !important; 
                margin-bottom: 10px !important;
                border-radius: 10px !important;
            }
            .auth-modal button#authBtn { 
                height: 50px !important; 
                font-size: 1.1rem !important; 
                border-radius: 10px !important;
            }
        }
    </style>
</head>
<body oncontextmenu="return false" onselectstart="return false" ondragstart="return false">
    <div class="auth-overlay">
        <div class="auth-modal">
            <div class="external-link-section" id="kakaoOnly">
                <button class="external-btn-text" onclick="exitToExternal()">
                    카톡 이용 중이라면? 사파리/크롬으로 열기 ↗
                </button>
            </div>

            <h2 onclick="handleAdminClick()">학생 인증</h2>
            <p>정보를 정확히 입력하세요.</p>
            
            <div style="text-align:left; font-size:0.8rem; font-weight:700; color:#64748b; margin-bottom:5px; margin-left:5px;">교실 선택</div>
            <div class="class-selector">
                <label class="class-option"><input type="radio" name="classSelect" value="501"><span class="class-label">501</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="601"><span class="class-label">601</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="602"><span class="class-label">602</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="603"><span class="class-label">603</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="701"><span class="class-label">701</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="702"><span class="class-label">702</span></label>
                <label class="class-option"><input type="radio" name="classSelect" value="703"><span class="class-label">703</span></label>
            </div>

            <input type="text" id="userNameInput" placeholder="성함 (예: 홍길동)">
            <input type="password" id="pwInput" placeholder="Password">
            
            <button id="authBtn" onclick="handleAuth()">인증 및 시작하기</button>
            <p id="errorMsg" style="display:none; color:red; margin-top:5px; font-size:0.85rem;">정보가 올바르지 않습니다.</p>
        </div>
    </div>

    <script>
    (function() {
        if (navigator.userAgent.toLowerCase().indexOf('kakaotalk') > -1) {
            document.getElementById('kakaoOnly').style.display = 'flex';
        }
    })();

    function exitToExternal() {
        // [수정] 아이폰에서 로딩만 돌던 현상 해결을 위한 직통 주소 체계
        const targetUrl = window.location.href.split('/start/')[0] + '/index.html';
        const ua = navigator.userAgent.toLowerCase();

        if (ua.indexOf('iphone') > -1 || ua.indexOf('ipad') > -1) {
            // 아이폰 전용 사파리 강제 탈출 스위치
            location.href = targetUrl + (targetUrl.includes('?') ? '&' : '?') + 'open_external_browser=1';
        } else if (ua.indexOf('android') > -1) {
            location.href = 'intent://' + targetUrl.replace(/https?:\/\//i, '') + '#Intent;scheme=http;package=com.android.chrome;end';
        } else {
            window.location.href = targetUrl;
        }
    }

    // [handleAuth 및 나머지 원본 로직은 기존 파일 내용을 그대로 붙여넣어 주세요]
    </script>
</body>
</html>