<script>
    (function() {
        // 출입증이 없는 경우에만 쫓아냅니다.
        if (sessionStorage.getItem('auth_status') !== 'verified') {
            alert('보안 인증이 필요합니다.');
            // 파일 위치에 따라 lock.html을 찾아가는 경로를 정확히 적어주세요.
            // 예: 01자격증선택.html에서는 'lock.html'
            // 예: 03차체수리통합.html에서는 '../../lock.html'
            window.location.replace('../../lock.html'); 
        }
    })();
</script>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>차체수리 마스터 CBT</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="../통합랜덤.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css">
</head>
<body class="light-mode font-medium" id="main-body">

    <nav class="top-nav no-drag">
        <div class="nav-inner">
            <h1 id="main-title" onclick="handleTitleClick()" style="cursor:pointer">◀ 차체수리</h1>
            <div id="quiz-status-area" class="hidden status-group">
                <span id="timer-display" class="status-badge">60:00</span>
                <span id="progress-display" class="status-badge">
                    <span id="solved-count">0</span> / <span id="total-count">0</span>
                </span>
                <button class="btn-submit-final" onclick="handleFinishSubmit()">시험 제출</button>
            </div>
            <div class="nav-right">
                <button id="theme-btn" class="btn-icon-theme" onclick="toggleTheme()">☀️ 라이트</button>
            </div>
        </div>
    </nav>

    <main class="container">
        <section id="home-screen" class="active-screen">
    
    <div class="main-sticky-wrapper">
        
        <div class="banner-flex-row no-drag">
            <div class="dashboard glass-card">
                <div class="stat-container">
                    <div class="stat-row">
                        <div class="stat-pill">최근: <strong id="stat-last">0</strong>점</div>
                        <div class="stat-pill">평균: <strong id="stat-avg">0</strong>점</div>
                    </div>
                    <div class="dashboard-btns" style="display: flex; gap: 8px; margin-top: 10px; width: 100%;">
                        <button class="btn-open-chart" style="flex: 1; padding: 12px 0;" onclick="openStatsModal()">성적통계</button>
                        <button class="btn-open-link" 
        style="flex: 1; padding: 12px 0; background: #6366f1; color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; font-family: 'Pretendard';" 
        onclick="window.open('https://blog.naver.com/ddsp0201/223713417263')">블로그문제</button>
                    </div>
                </div>
            </div>

            <div class="settings-panel-slim glass-card">
                <div class="settings-flex">
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-one-by-one" onchange="toggleViewMode()">
                            <span class="slider"></span><span class="lbl-txt">한문제씩</span>
                        </label>
                    </div>
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-instant-feedback" onchange="syncInstantMode(this)">
                            <span class="slider"></span><span class="lbl-txt">즉시해설</span>
                        </label>
                    </div>
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="multi-mode-chk" onchange="toggleMultiMode()">
                            <span class="slider"></span><span class="lbl-txt">회차랜덤</span>
                        </label>
                    </div>
                    <button id="btn-multi-start" class="hidden" onclick="startExam('multi')">선택 회차<br>80문제 시작</button>
                </div>
            </div>
        </div>

        <div class="main-action-independent no-drag">
            <button class="btn-unified-action blue-style" onclick="startExam('full')">🎲 전체 범위 랜덤 풀기 (80문항)</button>
        </div>

        <div class="wrong-note-section glass-card no-drag">
            <div class="accordion-trigger" onclick="toggleWrongAccordion()">
                <span>📕 회차별 오답 기록</span>
                <span id="wrong-arrow-icon">▼</span>
            </div>
            <div id="wrong-content-area" class="accordion-body hidden">
                <div class="wrong-header-btns" style="display:flex; justify-content:space-between; align-items:center;">
                    <button onclick="openConfirmBanner('reset')" class="btn-danger-mini">전체 오답 초기화</button>
                    <button id="btn-wrong-multi-start" class="btn-wrong-multi hidden" onclick="startMultiWrongReview()">🚀 선택 회차 모아풀기</button>
                </div>
                <div class="wrong-scroll-container" style="max-height: 250px; overflow-y: auto; margin-top: 10px;">
                    <div id="wrong-list-display"></div>
                </div>
            </div>
        </div>

    </div> <div id="round-grid-display" class="round-card-grid no-drag"></div>

</section>

        <section id="quiz-screen" class="hidden">
            <div class="quiz-quick-settings-fixed no-drag">
                <div class="quick-flex-container">
                    <div class="quick-item" id="auto-scroll-wrap">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-auto-scroll" checked>
                            <span class="slider"></span><span class="lbl-txt">자동 이동</span>
                        </label>
                    </div>
                    <div class="quick-item" id="left-hand-wrap">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-left-hand" onchange="applyLeftHand(this.checked)">
                            <span class="slider"></span><span class="lbl-txt">왼손잡이</span>
                        </label>
                    </div>
                    <div class="quick-item font-control-box">
                        <button class="btn-f-size active" onclick="toggleFontControl()" style="width: auto; padding: 4px 12px; min-width: 110px;">
                            글자 크기 조절 ⚙️
                        </button>
                    </div>
                </div>
            </div>

            <div class="quiz-main-layout">
                <div class="question-column">
                    <div id="quiz-display-area"></div>
                </div>
                
                <aside id="omr-sidebar" class="omr-column no-drag">
                    <div class="omr-sticky-card glass-card">
                        <div class="omr-bulk-marking-pc">
                            <span class="bulk-lbl-pc">문제 밀기:</span>
                            <div class="bulk-btns-pc">
    <button onclick="pushAllAnswers(0)">1</button>
    <button onclick="pushAllAnswers(1)">2</button>
    <button onclick="pushAllAnswers(2)">3</button>
    <button onclick="pushAllAnswers(3)">4</button>
    <button onclick="undoPushAnswers()" style="background:#64748b; color:white; margin-left:5px; font-size:0.7rem;">밀기취소</button>
</div>
                        </div>
                        <div id="omr-buttons-grid"></div>
                    </div>
                </aside>
            </div>
</div> <div id="instant-exp-overlay" class="instant-exp-panel no-drag hidden">
                <div id="instant-exp-content"></div>
                <button class="btn-close-exp" onclick="closeInstantExp()">해설 접기 ▼</button>
            </div>
            <button id="btn-open-exp" class="btn-open-exp-mini hidden" onclick="openInstantExp()">해설 열기 ▲</button>

            <footer class="quiz-bottom-nav no-drag" id="quiz-nav-group">
                <button class="btn-nav-prev" id="btn-move-prev" onclick="moveQuestion(-1)">이전 문제</button>
                <button class="btn-nav-next" id="btn-move-next" onclick="moveQuestion(1)">다음 문제</button>
            </footer>

            <div id="font-control-banner" class="font-banner hidden no-drag">
                <div class="banner-header">
                    <span>글자 크기 정밀 설정</span>
                    <button class="btn-close-banner" onclick="toggleFontControl()">×</button>
                </div>
                <div class="banner-body">
   <div class="slider-group">
    <label>문제 글자 크기</label>
    <input type="range" id="slider-q-size" min="0.5" max="3.5" step="0.01" oninput="updateFontSize('q', this.value)">
    <span id="val-q-size">1.20</span>
</div>
<div class="slider-group">
    <label>보기 창 크기 (높이)</label>
    <input type="range" id="slider-opt-height" min="30" max="120" step="1" oninput="updateOptHeight(this.value)">
    <span id="val-opt-height">55</span>
</div>
                </div>
            </div>

            <div id="instant-exp-overlay" class="instant-exp-panel no-drag hidden">
                <div id="instant-exp-content"></div>
                <button class="btn-close-exp" onclick="closeInstantExp()">해설 접기 ▼</button>
            </div>
            <button id="btn-open-exp" class="btn-open-exp-mini hidden" onclick="openInstantExp()">해설 열기 ▲</button>

        </section> <section id="result-screen" class="hidden">
            <div class="result-summary-fixed no-drag">
                <div class="res-fixed-inner glass-card">
                    <div class="res-score-line">
                        <strong id="final-result-score" class="score-highlight">0</strong>점
                    </div>
                    <div class="res-action-btns-mini">
                        <button class="btn-res-sm home" onclick="goBackToMain()">메인</button>
                        <button class="btn-res-sm retry" onclick="retryCurrentExam(false)">전체 다시풀기</button>
                        <button class="btn-res-sm wrong" onclick="retryCurrentExam(true)">오답 다시풀기</button>
                    </div>
                </div>
            </div>
            
            <div class="quiz-main-layout review-margin-top">
                <div class="question-column" id="review-list-container"></div>
                
                <aside id="result-omr-sidebar" class="omr-column no-drag">
                    <div class="omr-sticky-card glass-card">
                        <div class="omr-header-pc">📊 결과 리포트</div>
                        <div id="result-omr-buttons-grid"></div>
                    </div>
                </aside>
            </div>
        </section>
    </main>

    <div id="modal-stats-overlay" class="modal-overlay hidden no-drag" onclick="handleOverlayClick(event)">
        <div class="modal-window glass-card" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="stat-chart-title" onclick="handleSecretReset(event)" style="cursor:help">📊 나의 성적 변화 추이</h3>
                <button class="btn-close-modal" onclick="closeStatsModal()">&times;</button>
            </div>
            <div class="chart-wrapper" id="chart-scroll-box">
                <div id="chart-canvas-area"></div>
            </div>
            <p class="chart-desc">가장 우측이 최근 성적입니다.</p>
        </div>
    </div>


    <div id="confirm-banner" class="modal-overlay hidden no-drag">
    <div class="modal-window confirm-modal-window"> <div class="banner-header">
            <span>⚠️ 시험 제출 확인</span>
            <button class="btn-close-banner" onclick="closeConfirmBanner()">×</button>
        </div>
        <div class="banner-body">
            <p>
                <strong>모든 문제를 다 푸셨나요?</strong><br>
                제출 후에는 정답과 해설이 표시됩니다.
            </p>
            <div class="banner-footer-btns">
                <button class="btn-banner-submit" onclick="realSubmit()">네, 제출합니다</button>
                <button class="btn-banner-close" onclick="closeConfirmBanner()">취소</button>
            </div>
        </div>
    </div>
</div>
    <script src="03차체수리문제.js"></script> 
    <script src="03차체수리통합.js"></script>
</body>
</html>