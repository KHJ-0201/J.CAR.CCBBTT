import { industry010301, industry010302, industry010303, industry010304, industry010305 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0103ìë™ì°¨ ëƒ‰ë‚œë°©ì¥ì¹˜ì •ë¹„/industry_ëƒ‰ë‚œë°©ë¬¸ì œ.js';
import { industry010401, industry010402, industry010403, industry010404, industry010405 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0104ìë™ì°¨ ì „ê¸°ì „ìíšŒë¡œë¶„ì„/industry_íšŒë¡œë¶„ì„ë¬¸ì œ.js';
import { industry010501, industry010502, industry010503, industry010504, industry010505 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0105ìë™ì°¨ í¸ì˜ì¥ì¹˜ ì •ë¹„/industry_í¸ì˜ì¥ì¹˜ë¬¸ì œ.js';
import { industry010701, industry010702, industry010703, industry010704, industry010705 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0107ìë™ì°¨ ì£¼í–‰ì•ˆì „ì¥ì¹˜ì •ë¹„/industry_ì£¼í–‰ì•ˆì „ë¬¸ì œ.js';
import { industry010801, industry010802, industry010803, industry010804, industry010805 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0108ìë™ì°¨ ë„¤íŠ¸ì›Œí¬í†µì‹ ì¥ë¹„ì •ë¹„/industry_ë„¤íŠ¸ì›Œí¬ë¬¸ì œ.js';
import { industry010901, industry010902, industry010903, industry010904, industry010905 } from './ìë™ì°¨ ì „ê¸°ì „ìì¥ì¹˜ ì •ë¹„/0109í•˜ì´ë¸Œë¦¬ë“œìë™ì°¨ íŠ¹í™”ì‹œìŠ¤í…œì •ë¹„/industry_í•˜ì´ë¸Œë¦¬ë“œë¬¸ì œ.js';
import { industry020101, industry020102, industry020103, industry020104, industry020105 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0201ì—”ì§„ë³¸ì²´ì •ë¹„/industry_ì—”ì§„ë³¸ì²´ë¬¸ì œ.js';
import { industry020201, industry020202, industry020203, industry020204, industry020205 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0202ëƒ‰ê°ì¥ì¹˜ì •ë¹„/industry_ëƒ‰ê°ì¥ì¹˜ë¬¸ì œ.js';
import { industry020301, industry020302, industry020303, industry020304, industry020305 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0203ìœ¤í™œì¥ì¹˜ì •ë¹„/industry_ìœ¤í™œì¥ì¹˜ë¬¸ì œ.js';
import { industry020401, industry020402, industry020403, industry020404, industry020405 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0204ì—°ë£Œì¥ì¹˜ì •ë¹„/industry_ì—°ë£Œì¥ì¹˜ë¬¸ì œ.js';
import { industry020501, industry020502, industry020503, industry020504, industry020505 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0205ì—”ì§„ì í™”ì¥ì¹˜ì •ë¹„/industry_ì—”ì§„ì í™”ì¥ì¹˜ë¬¸ì œ.js';
import { industry020601, industry020602, industry020603, industry020604, industry020605 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0206í¡ë°°ê¸°ì œì–´ì¥ì¹˜ì •ë¹„/industry_í¡ë°°ê¸°ì œì–´ì¥ì¹˜ë¬¸ì œ.js';
import { industry020701, industry020702, industry020703, industry020704, industry020705 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0207ê³¼ê¸‰ì¥ì¹˜ì •ë¹„/industry_ê³¼ê¸‰ì¥ì¹˜ë¬¸ì œ.js';
import { industry020801, industry020802, industry020803, industry020804, industry020805 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0208ê°€ì†”ë¦°ì „ìì œì–´ì¥ì¹˜ì •ë¹„/industry_ê°€ì†”ë¦°ì „ìë¬¸ì œ.js';
import { industry021001, industry021002, industry021003, industry021004, industry021005 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0210ë””ì ¤ì „ìì œì–´ì¥ì¹˜ì •ë¹„/industry_ë””ì ¤ì „ìë¬¸ì œ.js';
import { industry021201, industry021202, industry021203, industry021204, industry021205 } from './ìë™ì°¨ ì—”ì§„ ì •ë¹„/0212ë°°ì¶œê°€ìŠ¤ì œì–´ì¥ì¹˜ì •ë¹„/industry_ë°°ì¶œê°€ìŠ¤ë¬¸ì œ.js';
import { industry030301, industry030302, industry030303, industry030304, industry030305 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0303ìë™ë³€ì†ê¸°ì •ë¹„/industry_ìë™ë³€ì†ë¬¸ì œ.js';
import { industry030801, industry030802, industry030803, industry030804, industry030805 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0308ìœ ì••ì‹í˜„ê°€ì¥ì¹˜ì •ë¹„/industry_ìœ ì••ì‹í˜„ê°€ë¬¸ì œ.js';
import { industry030901, industry030902, industry030903, industry030904, industry030905 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0309ì „ìì œì–´í˜„ê°€ì¥ì¹˜ì •ë¹„/industry_ì „ìì œì–´í˜„ê°€ë¬¸ì œ.js';
import { industry032401, industry032402, industry032403, industry032404, industry032405 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0324íœ íƒ€ì´ì–´ì–¼ë¼ì¸ë¨¼íŠ¸ì •ë¹„/industry_ì–¼ë¼ì¸ë¨¼íŠ¸ë¬¸ì œ.js';
import { industry032601, industry032602, industry032603, industry032604, industry032605 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0326ì¡°í–¥ì¥ì¹˜ì •ë¹„/industry_ì¡°í–¥ì¥ì¹˜ë¬¸ì œ.js';
import { industry032701, industry032702, industry032703, industry032704, industry032705 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0327ì œë™ì¥ì¹˜ì •ë¹„/industry_ì œë™ì¥ì¹˜ë¬¸ì œ.js';
import { industry032801, industry032802, industry032803, industry032804, industry032805 } from './ìë™ì°¨ ì„€ì‹œ ì •ë¹„/0328ì£¼í–‰ì•ˆì „ë³´ì¡°ì‹œìŠ¤í…œì •ë¹„/industry_ì£¼í–‰ì•ˆì „ë¬¸ì œ.js';


// 1. ë¬¸ì œë“¤ì„ ì£¼ì œë³„(ê³¼ëª©ë³„)ë¡œ ê·¸ë£¹í™”í•©ë‹ˆë‹¤.
const TOPIC_GROUPS = {
Â  Â  '0103': [industry010301, industry010302, industry010303, industry010304, industry010305], // ì „ê¸°
Â  Â  '0104': [industry010401, industry010402, industry010403, industry010404, industry010405], 
Â  Â  '0105': [industry010501, industry010502, industry010503, industry010504, industry010505], 
Â  Â  '0107': [industry010701, industry010702, industry010703, industry010704, industry010705], 
Â  Â  '0108': [industry010801, industry010802, industry010803, industry010804, industry010805], 
Â  Â  '0109': [industry010901, industry010902, industry010903, industry010904, industry010905],
Â  Â  '0201': [industry020101, industry020102, industry020103, industry020104, industry020105], // ì—”ì§„
Â  Â  '0202': [industry020201, industry020202, industry020203, industry020204, industry020205], 
Â  Â  '0203': [industry020301, industry020302, industry020303, industry020304, industry020305], 
Â  Â  '0204': [industry020401, industry020402, industry020403, industry020404, industry020405], 
Â  Â  '0205': [industry020501, industry020502, industry020503, industry020504, industry020505], 
Â  Â  '0206': [industry020601, industry020602, industry020603, industry020604, industry020605], 
Â  Â  '0207': [industry020701, industry020702, industry020703, industry020704, industry020705], 
Â  Â  '0208': [industry020801, industry020802, industry020803, industry020804, industry020805], 
Â  Â  '0210': [industry021001, industry021002, industry021003, industry021004, industry021005], 
Â  Â  '0212': [industry021201, industry021202, industry021203, industry021204, industry021205],
Â  Â  '0303': [industry030301, industry030302, industry030303, industry030304, industry030305], // ì„€ì‹œ
Â  Â  '0308': [industry030801, industry030802, industry030803, industry030804, industry030805], 
Â  Â  '0309': [industry030901, industry030902, industry030903, industry030904, industry030905], 
Â  Â  '0324': [industry032401, industry032402, industry032403, industry032404, industry032405], 
Â  Â  '0326': [industry032601, industry032602, industry032603, industry032604, industry032605], 
Â  Â  '0327': [industry032701, industry032702, industry032703, industry032704, industry032705], 
Â  Â  '0328': [industry032801, industry032802, industry032803, industry032804, industry032805] Â  Â  Â 

};

// ê³¼ëª© ì½”ë“œëª…ì„ ì‹¤ì œ ê³¼ëª© ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” ë°ì´í„°
const TOPIC_NAMES = {
Â  Â  '0103': 'ìë™ì°¨ ëƒ‰Â·ë‚œë°©ì¥ì¹˜ ì •ë¹„',
Â  Â  '0104': 'ìë™ì°¨ ì „ê¸°Â·ì „ìíšŒë¡œë¶„ì„',
Â  Â  '0105': 'ìë™ì°¨ í¸ì˜ì¥ì¹˜ ì •ë¹„',
Â  Â  '0107': 'ìë™ì°¨ ì£¼í–‰ì•ˆì „ì¥ì¹˜ ì •ë¹„',
Â  Â  '0108': 'ìë™ì°¨ ë„¤íŠ¸ì›Œí¬í†µì‹ ì¥ë¹„ ì •ë¹„',
Â  Â  '0109': 'í•˜ì´ë¸Œë¦¬ë“œìë™ì°¨ íŠ¹í™”ì‹œìŠ¤í…œì •ë¹„',
Â  Â  '0201': 'ì—”ì§„ë³¸ì²´ ì •ë¹„',
Â  Â  '0202': 'ëƒ‰ê°ì¥ì¹˜ ì •ë¹„',
Â  Â  '0203': 'ìœ¤í™œì¥ì¹˜ ì •ë¹„',
Â  Â  '0204': 'ì—°ë£Œì¥ì¹˜ ì •ë¹„',
Â  Â  '0205': 'ì—”ì§„ì í™”ì¥ì¹˜ ì •ë¹„',
Â  Â  '0206': 'í¡Â·ë°°ê¸°ì œì–´ì¥ì¹˜ ì •ë¹„',
Â  Â  '0207': 'ê³¼ê¸‰ì¥ì¹˜ ì •ë¹„',
Â  Â  '0208': 'ê°€ì†”ë¦° ì „ìì œì–´ì¥ì¹˜ ì •ë¹„',
Â  Â  '0210': 'ë””ì ¤ ì „ìì œì–´ì¥ì¹˜ ì •ë¹„',
Â  Â  '0212': 'ë°°ì¶œê°€ìŠ¤ ì œì–´ì¥ì¹˜ ì •ë¹„',
Â  Â  '0303': 'ìë™ë³€ì†ê¸° ì •ë¹„',
Â  Â  '0308': 'ìœ ì••ì‹ í˜„ê°€ì¥ì¹˜ ì •ë¹„',
Â  Â  '0309': 'ì „ìì œì–´ í˜„ê°€ì¥ì¹˜ ì •ë¹„',
Â  Â  '0324': 'íœ Â·íƒ€ì´ì–´Â·ì–¼ë¼ì¸ë¨¼íŠ¸ ì •ë¹„',
Â  Â  '0326': 'ì¡°í–¥ì¥ì¹˜ ì •ë¹„',
Â  Â  '0327': 'ì œë™ì¥ì¹˜ ì •ë¹„',
Â  Â  '0328': 'ì£¼í–‰ì•ˆì „ ë³´ì¡°ì‹œìŠ¤í…œ ì •ë¹„'
};

function getTopicName(code) {
Â  Â  return TOPIC_NAMES[code] || 'ë¯¸ë¶„ë¥˜';
}


// ë¬¸ì œ/ë³´ê¸° ëœë¤ ì„ê¸°
function shuffleArray(array) {
Â return array.sort(() => Math.random() - 0.5);
}

// ì¤‘ë³µ ì œê±° ë° ëœë¤ ì¶”ì¶œ
function selectUniqueRandomQuestions(sourceArray, count) {
Â  Â  const shuffled = shuffleArray([...sourceArray]);
Â  Â  const selected = [];
Â  Â  // Setì„ ì‚¬ìš©í•˜ì—¬ ë¬¸ì œ í…ìŠ¤íŠ¸ì˜ ì¤‘ë³µì„ í™•ì¸
Â  Â  const questionSet = new Set(); 
Â  Â  
Â  Â  for (const q of shuffled) {
Â  Â  Â  Â  if (!questionSet.has(q.question)) {
Â  Â  Â  Â  Â  Â  questionSet.add(q.question);
Â  Â  Â  Â  Â  Â  selected.push(q);
Â  Â  Â  Â  }
Â  Â  Â  Â  if (selected.length >= count) {
Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  return selected;
}

// 2. ê³¼ëª©ë³„ë¡œ ê· ë“±í•˜ê²Œ ë¬¸ì œ ìˆ˜ë¥¼ ì¶”ì¶œí•˜ëŠ” í•µì‹¬ í•¨ìˆ˜
function getBalancedQuestions(totalCount) {
Â  Â  const topicKeys = Object.keys(TOPIC_GROUPS); 
Â  Â  const topicCount = topicKeys.length; 
Â  Â  
Â  Â  // ê³¼ëª©ë‹¹ ê· ë“±í•˜ê²Œ í• ë‹¹í•  ë¬¸ì œ ìˆ˜ ê³„ì‚°
Â  Â  const basePerTopic = Math.floor(totalCount / topicCount);
Â  Â  let remainder = totalCount % topicCount;
Â  Â  
Â  Â  let balancedQuestions = [];
Â  Â  
Â  Â  for (const key of topicKeys) {
Â  Â  Â  Â  const countToSelect = basePerTopic + (remainder > 0 ? 1 : 0);
Â  Â  Â  Â  if (remainder > 0) remainder--;

Â  Â  Â  Â  const allTopicQuestions = TOPIC_GROUPS[key].flat();
Â  Â  Â  Â  
Â  Â  Â  Â  const selectedForTopic = selectUniqueRandomQuestions(allTopicQuestions, countToSelect);
Â  Â  Â  Â  
Â  Â  Â  Â  // ì¶”ì¶œëœ ë¬¸ì œì— topicCode ì†ì„± ì¶”ê°€
Â  Â  Â  Â  const questionsWithTopic = selectedForTopic.map(q => ({
Â  Â  Â  Â  Â  Â  ...q,
Â  Â  Â  Â  Â  Â  topicCode: key 
Â  Â  Â  Â  }));
Â  Â  Â  Â  
Â  Â  Â  Â  balancedQuestions.push(...questionsWithTopic);
Â  Â  }

Â  Â  return balancedQuestions;
}

/* ===========================
Â  Â  âœ¨ [ìˆ˜ì •/í†µí•©] ë¬¸ì œ ìˆœì„œ ë° ë³´ê¸° ìˆœì„œë¥¼ ì„ëŠ” í†µí•© í•¨ìˆ˜
=========================== */
function applyShuffling(questionsArray) {
Â  Â  // 1. ë¬¸ì œ ìˆœì„œ ëœë¤í™”
Â  Â  const shuffledQuestions = shuffleArray(questionsArray); 

Â  Â  // 2. ë³´ê¸° ìˆœì„œ ëœë¤í™” ë° ì •ë‹µ ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸
Â  Â  shuffledQuestions.forEach((q) => {
Â  Â  Â  Â  // ë³´ê¸° ë°°ì—´ í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë³´ê¸° ë°°ì—´ ìƒì„±
Â  Â  Â  Â  let combined = q.options.map((opt) => ({ opt }));
Â  Â  Â  Â  combined = shuffleArray(combined);

Â  Â  Â  Â  // q.optionsë¥¼ ì„ì¸ ìƒˆ ë°°ì—´ë¡œ ì—…ë°ì´íŠ¸
Â  Â  Â  Â  q.options = combined.map((c) => c.opt);

Â  Â  Â  Â  // ìƒˆë¡œìš´ q.answer ì¸ë±ìŠ¤ ì°¾ê¸°: ì €ì¥í•´ ë‘” ì •ë‹µ í…ìŠ¤íŠ¸ê°€ ìƒˆ ë°°ì—´ì—ì„œ ëª‡ ë²ˆì§¸ì— ìˆëŠ”ì§€ ì°¾ìŠµë‹ˆë‹¤.
Â  Â  Â  Â  const newAnswerIndex = q.options.findIndex(opt => opt === q.originalCorrectOptionText);
Â  Â  Â  Â  
Â  Â  Â  Â  // ìƒˆë¡œìš´ ì •ë‹µ ì¸ë±ìŠ¤ í• ë‹¹
Â  Â  Â  Â  if (newAnswerIndex !== -1) {
Â  Â  Â  Â  Â  Â  q.answer = newAnswerIndex;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  console.error("ì •ë‹µ í…ìŠ¤íŠ¸ë¥¼ ìƒˆë¡œìš´ ë³´ê¸° ë°°ì—´ì—ì„œ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", q.originalCorrectOptionText);
Â  Â  Â  Â  Â  Â  q.answer = -1; 
Â  Â  Â  Â  }
Â  Â  });

Â  Â  return shuffledQuestions; // ë¬¸ì œ ìˆœì„œê°€ ì„ì¸ ë°°ì—´ ë°˜í™˜
}

// ë¬¸ì œ ìˆœì„œ ëœë¤ + 80ë¬¸ì œ ì œí•œ (ê· ë“± ì¶”ì¶œ í•¨ìˆ˜ ì‚¬ìš©)
let questions = getBalancedQuestions(80);

// âœ¨ 1ì°¨ ì…”í”Œ ì´ì „ì— ì •ë‹µ í…ìŠ¤íŠ¸ë¥¼ ì €ì¥í•´ë‘¡ë‹ˆë‹¤. (ì¬í’€ì´ë¥¼ ìœ„í•¨)
questions.forEach(q => {
Â  Â  // q.originalCorrectOptionTextê°€ ì—†ìœ¼ë©´, ì´ˆê¸° ì •ë‹µ í…ìŠ¤íŠ¸ë¥¼ ì €ì¥
Â  Â  if (!q.originalCorrectOptionText) {
Â  Â  Â  Â  // q.answerëŠ” ì´ˆê¸° ì •ë‹µ ì˜µì…˜ì˜ ì¸ë±ìŠ¤ë¼ê³  ê°€ì •
Â  Â  Â  Â  q.originalCorrectOptionText = q.options[q.answer]; 
Â  Â  }
});

// âœ¨ ì…”í”Œ ë¡œì§ì„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ì—¬ í˜¸ì¶œ
questions = applyShuffling(questions);

// ë‹µì•ˆ ì €ì¥
let answers = Array(questions.length).fill(-1);


// ë¬¸ì œë¡œ ìŠ¤í¬ë¡¤ ì´ë™ í•¨ìˆ˜ 
function scrollToQuestion(index) {
Â  Â  const questionDivs = document.getElementsByClassName("question");
Â  Â  if (questionDivs[index]) {
Â  Â  Â  Â  // ë¬¸ì œ DIVì˜ ì‹œì‘ ë¶€ë¶„ì´ ë·°í¬íŠ¸ ìƒë‹¨ì— ì˜¤ë„ë¡ ìŠ¤í¬ë¡¤
Â  Â  Â  Â  questionDivs[index].scrollIntoView({ behavior: 'smooth', block: 'center' }); 
Â  Â  }
}


// ë‚¨ì€ ë¬¸ì œ í‘œì‹œ 
function updateRemaining() {
Â  Â  const remainingDiv = document.getElementById("remaining");
Â  Â  let answered = answers.filter((a) => a >= 0).length;
Â  Â  remainingDiv.textContent = `ë‚¨ì€ ë¬¸ì œ: ${questions.length - answered}/${questions.length}`;
}


// ë¬¸ì œ ë Œë”ë§
function renderQuiz() {
Â  Â  const quizDiv = document.getElementById("quiz");
Â  Â  quizDiv.innerHTML = "";
    document.getElementById("roundTitle").textContent = "ì „ê¸°ì „ì+ì—”ì§„+ì„€ì‹œ ì „ì²´ëœë¤"; // ìƒë‹¨ ì œëª© ì„¤ì •

Â  Â  questions.forEach((q, i) => {
Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  div.className = "question";
Â  Â  Â  Â  
Â  Â  Â  Â  // ê³¼ëª© ì½”ë“œ(ì´ë¦„)ë¥¼ í‘œì‹œ
Â  Â  Â  Â  const topicName = getTopicName(q.topicCode);

Â  Â  Â  Â  // âœ¨ ìˆ˜ì •: ì—”ì§„í†µí•©.jsì™€ ë™ì¼í•˜ê²Œ q-header ì œê±°í•˜ê³  <p class="module-title"> ì‚¬ìš©
Â  Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  Â  Â  <span id="q-status-${i}" class="q-status"></span>
Â  Â  Â  Â  Â  Â  <strong class="q-title">${i + 1}. ${q.question}</strong>
Â  Â  Â  Â  Â  Â  <p class="module-title">[${topicName}]</p> Â  Â  Â  Â  `;

Â  Â  Â  Â  // imagePath ì†ì„±ì´ ìˆëŠ”ì§€ í™•ì¸
Â  Â  Â  Â  if (q.imagePath) {
Â  Â  Â  Â  Â  Â  div.innerHTML += `<img 
Â  Â  Â  Â  Â  Â  Â  Â  src="${q.imagePath}" 
Â  Â  Â  Â  Â  Â  Â  Â  alt="ë¬¸ì œ ê·¸ë¦¼" 
Â  Â  Â  Â  Â  Â  Â  Â  style="width: 500px; height: auto; margin: 15px 0;"
Â  Â  Â  Â  Â  Â  >`;
Â  Â  Â  Â  }

Â  Â  Â  Â  const optsDiv = document.createElement("div");
Â  Â  Â  Â  optsDiv.className = "options";
Â  Â  Â  Â  q.options.forEach((opt, j) => {
Â  Â  Â  Â  Â  Â  const label = document.createElement("label");
Â  Â  Â  Â  Â  Â  label.innerHTML = `<input type="radio" name="q${i}" value="${j}"> ${opt}`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const radioInput = label.querySelector("input");
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ë¼ë””ì˜¤ ë²„íŠ¼ change ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
Â  Â  Â  Â  Â  Â  radioInput.addEventListener("change", () => {
Â  Â  Â  Â  Â  Â  answers[i] = j;
Â  Â  Â  Â  Â  Â  updateRemaining(); // OMR ìƒíƒœ ì—…ë°ì´íŠ¸ í¬í•¨

Â  Â  Â  Â  Â  Â  const allLabels = optsDiv.querySelectorAll('label');
Â  Â  Â  Â  Â  Â  allLabels.forEach(l => l.classList.remove('selected'));

Â  Â  Â  Â  Â  Â  label.classList.add('selected');

Â  Â  Â  Â  Â  Â  // ë³´ê¸° í´ë¦­ ì‹œ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™í•˜ëŠ” ë¡œì§ 
Â  Â  Â  Â  Â  Â  if (i < questions.length - 1) {
Â  Â  Â  Â  Â  Â  Â  Â  scrollToQuestion(i + 1); 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  optsDiv.appendChild(label);
Â  Â  Â  Â  });
Â  Â  Â  Â  div.appendChild(optsDiv);

Â  Â  Â  Â  const explainDiv = document.createElement("div");
Â  Â  Â  Â  explainDiv.className = "explain";
Â  Â  Â  Â  div.appendChild(explainDiv);

Â  Â  Â  Â  quizDiv.appendChild(div);
Â  Â  });

Â  Â  updateRemaining();
}

// -----------------------------
// ì œì¶œ ë° ì±„ì 
function submitQuiz() {
Â  Â  // 1. ì•ˆ í‘¼ ë¬¸ì œ ì¸ë±ìŠ¤ í™•ì¸
Â  Â  const firstUnansweredIndex = answers.findIndex((a) => a < 0);
Â  Â  const unansweredCount = answers.filter((a) => a < 0).length;

Â  Â  // 2. ì•ˆ í‘¼ ë¬¸ì œê°€ ìˆì„ ê²½ìš° í™•ì¸
Â  Â  if (unansweredCount > 0 && totalSeconds > 0) {
Â  Â  Â  Â  const confirmSubmit = confirm(
Â  Â  Â  Â  Â  Â  `ì•„ì§ ${unansweredCount}ê°œì˜ ë¬¸ì œë¥¼ í’€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nê³„ì† ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì·¨ì†Œ ì‹œ ë¬¸ì œí’€ì´ ê³„ì† ë° ì²« ì•ˆ í‘¼ ë¬¸ì œë¡œ ì´ë™)`
Â  Â  Â  Â  );
Â  Â  Â  Â  
Â  Â  Â  Â  if (!confirmSubmit) {
Â  Â  Â  Â  Â  Â  if (firstUnansweredIndex !== -1) {
Â  Â  Â  Â  Â  Â  Â  Â  // ë¬¸ì œë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤ ì´ë™
Â  Â  Â  Â  Â  Â  Â  Â  scrollToQuestion(firstUnansweredIndex);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  }

Â  Â  clearInterval(timerInterval);
Â  Â  document.getElementById("timer").textContent = "";

Â  Â  let score = 0;
Â  Â  window.scrollTo({
Â  Â  top: 0,
Â  Â  behavior: 'smooth'
Â  Â  });
Â  Â  
Â  Â  questions.forEach((q, i) => {
Â  Â  const questionDiv = document.getElementsByClassName("question")[i];
Â  Â  const explainDiv = questionDiv.querySelector(".explain");
Â  Â  const labels = questionDiv.querySelectorAll('label'); 
Â  Â  const statusSpan = document.getElementById(`q-status-${i}`); 
Â  Â  
Â  Â  // ì´ì „ ìƒíƒœ í´ë˜ìŠ¤ ì´ˆê¸°í™”
Â  Â  statusSpan.classList.remove('status-correct', 'status-wrong', 'status-unanswered');

Â  Â  // ğŸ’¡ ë¬¸ì œ ìƒíƒœì— ë”°ë¼ ì•„ì´ì½˜/ìƒ‰ìƒ/í´ë˜ìŠ¤ ê²°ì •
Â  Â  if (answers[i] == q.answer) {
Â  Â  Â  Â  // ì •ë‹µ: â­• 
Â  Â  Â  Â  score++;
Â  Â  Â  Â  labels[q.answer].style.backgroundColor = "#b6fcb6";
Â  Â  Â  Â  statusSpan.innerHTML = 'â­•';
Â  Â  } else if (answers[i] >= 0) {
Â  Â  Â  Â  // ì˜¤ë‹µ: âŒ 
Â  Â  Â  Â  labels[q.answer].style.backgroundColor = "#b6fcb6"; // ì •ë‹µì€ ì´ˆë¡ìƒ‰
Â  Â  Â  Â  labels[answers[i]].style.backgroundColor = "#fcb6b6"; // ë‚´ê°€ ê³ ë¥¸ ì˜¤ë‹µì€ ë¹¨ê°„ìƒ‰
Â  Â  Â  Â  statusSpan.innerHTML = 'âŒ';
Â  Â  Â  Â  statusSpan.style.color = '#dc3545'; 
Â  Â  Â  Â  statusSpan.classList.add('status-wrong');
Â  Â  } else {
Â  Â  Â  Â  // ë¯¸ì‘ë‹µ: ì •ë‹µ ì˜µì…˜ í•˜ì´ë¼ì´íŠ¸ë§Œ ìœ ì§€
Â  Â  Â  Â  labels[q.answer].style.backgroundColor = "#b6fcb6"; // ì •ë‹µì€ ì´ˆë¡ìƒ‰
Â  Â  Â  Â  statusSpan.innerHTML = ''; 
Â  Â  Â  Â  statusSpan.style.color = ''; 
Â  Â  }

Â  Â  // ì±„ì  ì™„ë£Œ í›„ ê¸°íƒ€ ìŠ¤íƒ€ì¼ ì œê±° ë° í•´ì„¤ í‘œì‹œ
Â  Â  labels.forEach(l => l.classList.remove('selected'));

Â  Â  explainDiv.innerHTML = `
Â  Â  Â  Â  <div style="color: #1f3b73; font-weight: 700;">ì •ë‹µ: ${q.originalCorrectOptionText}</div>
Â  Â  Â  Â  <div style="margin-top: 5px;">${q.explain.trim()}</div> 
Â  Â  `;

Â  Â  questionDiv.querySelectorAll('input[type="radio"]').forEach((r) => (r.disabled = true));
Â  Â  });
Â  Â  
Â  Â  // ìƒë‹¨ ë°°ë„ˆì— ì ìˆ˜ í‘œì‹œ (Status Barì— 'ë‹¤ì‹œ í’€ê¸°' ë²„íŠ¼ ì¶”ê°€)
Â  Â  const status = document.getElementById("status");
Â  Â  status.classList.add("center");
Â  Â  
Â  Â  // 'ë‹¤ì‹œ í’€ê¸°' ë²„íŠ¼ì„ ìƒì„±í•˜ê³  ì´ë²¤íŠ¸ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.
Â  Â  const retryButton = document.createElement("button");
Â  Â  retryButton.textContent = "ë‹¤ì‹œ í’€ê¸°";
Â  Â  retryButton.id = "retryBtn";
Â  Â  // CSSì—ì„œ ì •ì˜ëœ ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ë„ë¡ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì œê±°
Â  Â  retryButton.addEventListener("click", resetQuiz);
Â  Â  
Â  Â  const scoreDisplaySpan = document.createElement('span');
Â  Â  scoreDisplaySpan.textContent = `ì „ê¸°ì „ì+ì—”ì§„+ì„€ì‹œ ì „ì²´ëœë¤ ì´ì : ${score}/${questions.length}`;
Â  Â  scoreDisplaySpan.id = 'scoreDisplay';
Â  Â  // CSSì—ì„œ ì •ì˜ëœ ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ë„ë¡ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì œê±°
Â  Â  
Â  Â  // âœ¨ ìˆ˜ì •: ì±„ì  ì™„ë£Œ í›„ h1 íƒœê·¸(ì œëª©)ë¥¼ ìˆ¨ê¸´ ì±„ ìœ ì§€í•˜ì—¬ resetQuiz ì‹œ ì‰½ê²Œ ë³µêµ¬
Â  Â  const mainTitleHtml = `<h1 id="mainTitle" style="display:none;">ì „ê¸°ì „ì+ì—”ì§„+ì„€ì‹œ ì „ì²´ëœë¤</h1>`;
Â  Â  status.innerHTML = mainTitleHtml; 
Â  Â  status.appendChild(scoreDisplaySpan);
Â  Â  status.appendChild(retryButton);
Â  Â  
Â  Â  // ì œì¶œ ë²„íŠ¼ ì œê±° (ë‘ ê°œ ëª¨ë‘)
Â  Â  document.getElementById("submitBtn").style.display = "none";
Â  Â  
Â  Â  const floatingSubmitBtn = document.getElementById("floatingSubmitBtn");
Â  Â  if (floatingSubmitBtn) {
Â  Â  Â  Â  floatingSubmitBtn.classList.add('hidden'); // í”Œë¡œíŒ… ì œì¶œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
Â  Â  }
Â  Â  
Â  Â  // ê²°ê³¼ì°½ í‘œì‹œ
Â  Â  const resultDiv = document.getElementById("result");
Â  Â  resultDiv.innerHTML = `<h2>ì „ê¸°ì „ì+ì—”ì§„+ì„€ì‹œ ì „ì²´ëœë¤ ì´ì : ${score}/${questions.length}</h2>`;
}

/* ===========================
Â  Â  âœ¨ [ìˆ˜ì •/í†µí•©] ë‹¤ì‹œ í’€ê¸° ë¡œì§ (ìˆœì„œ/ë³´ê¸° ì…”í”Œ í¬í•¨)
=========================== */
function resetQuiz() {
Â  Â  if (!confirm("í˜„ì¬ í’€ì—ˆë˜ 80ë¬¸ì œë¥¼ ë‹¤ì‹œ í‘¸ì‹œê² ìŠµë‹ˆê¹Œ? (ë¬¸ì œ ìˆœì„œ ë° ë³´ê¸° ìˆœì„œë„ ë‹¤ì‹œ ì„ì…ë‹ˆë‹¤.)")) {
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  // 1. ë¬¸ì œ ìˆœì„œ ë° ë³´ê¸° ìˆœì„œ ì¬ì…”í”Œ
Â  Â  questions = applyShuffling(questions); 
Â  Â  
Â  Â  // 2. ë‹µì•ˆ ì´ˆê¸°í™”
Â  Â  answers = Array(questions.length).fill(-1);
Â  Â  
Â  Â  // 3. íƒ€ì´ë¨¸ ì¬ì‹œì‘ (1ì‹œê°„ 40ë¶„ ì„¤ì • - ì´ˆê¸° ìŠ¤í¬ë¦°ìƒ· ì‹œê°„ ì°¸ì¡°)
Â  Â  clearInterval(timerInterval);
Â  Â  totalSeconds = 100 * 60; // 1ì‹œê°„ 40ë¶„
Â  Â  timerInterval = setInterval(updateTimer, 1000);
Â  Â  
Â  Â  // 4. UI ì´ˆê¸°í™” ë° ì¬ë Œë”ë§
Â  Â  
Â  Â  // Status Bar ë³µì› ë° íƒ€ì´ë¨¸ í‘œì‹œ
Â  Â  const status = document.getElementById("status");
Â  Â  status.classList.remove("center");
Â  Â  
Â  Â  // âœ¨ ìˆ˜ì •: ì—”ì§„í†µí•©ê³¼ ë™ì¼í•˜ê²Œ ë¶„:ì´ˆë§Œ í‘œì‹œ
Â  Â  const initialMinutes = Math.floor(totalSeconds / 60);
Â  Â  const initialSeconds = totalSeconds % 60;
Â  Â  
Â  Â  status.innerHTML = `
        <span id="timer">ë‚¨ì€ ì‹œê°„: ${initialMinutes.toString().padStart(2, "0")}:${initialSeconds.toString().padStart(2, "0")}</span>
Â  Â  Â  Â  <span id="roundTitle">ì „ê¸°ì „ì+ì—”ì§„+ì„€ì‹œ ì „ì²´ëœë¤</span> 
Â  Â  Â  Â  <span id="remaining">ë‚¨ì€ ë¬¸ì œ: ${questions.length}/${questions.length}</span>`;
Â  Â  
Â  Â  // ì œì¶œ ë²„íŠ¼ ë³µì› (ë‘ ê°œ ëª¨ë‘)
Â  Â  document.getElementById("submitBtn").style.display = "block";
Â  Â  
Â  Â  // --- [ì¶”ê°€] í”Œë¡œíŒ… ë²„íŠ¼ ë³µì› ---
Â  Â  const floatingSubmitBtn = document.getElementById("floatingSubmitBtn");
Â  Â  if (floatingSubmitBtn) {
Â  Â  Â  Â  floatingSubmitBtn.classList.remove('hidden');
Â  Â  }
Â  Â  // ---------------------------------
Â  Â  
Â  Â  // ê²°ê³¼ì°½ ìˆ¨ê¹€
Â  Â  document.getElementById("result").innerHTML = "";

Â  Â  // í€´ì¦ˆ ì˜ì—­ ì¬ë Œë”ë§
Â  Â  renderQuiz();
Â  Â  
Â  Â  // í™”ë©´ ìµœìƒë‹¨ìœ¼ë¡œ ì´ë™
Â  Â  window.scrollTo({ top: 0, behavior: 'smooth' });
}


// -----------------------------
// íƒ€ì´ë¨¸
let totalSeconds = 100 * 60; // 1ì‹œê°„ 40ë¶„ìœ¼ë¡œ ì´ˆê¸°í™”

function updateTimer() {
Â  Â  // âœ¨ ìˆ˜ì •: ì—”ì§„í†µí•©ê³¼ ë™ì¼í•˜ê²Œ ë¶„:ì´ˆë§Œ í‘œì‹œ
Â  Â  let m = Math.floor(totalSeconds / 60);
Â  Â  let s = totalSeconds % 60;

Â  Â  document.getElementById("timer").textContent =
Â  Â  Â  Â  `ë‚¨ì€ ì‹œê°„: ${m.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
Â  Â  
Â  Â  if (totalSeconds <= 0) {
Â  Â      submitQuiz();
Â  Â  } else {
Â  Â      totalSeconds--;
Â  Â  }
}
let timerInterval = setInterval(updateTimer, 1000);

// -----------------------------
// ì´ˆê¸°í™”
document.getElementById("submitBtn").addEventListener("click", submitQuiz);

// --- [ì¶”ê°€ ê¸°ëŠ¥ 2] í”Œë¡œíŒ… ë²„íŠ¼ ì—°ê²° ---
const floatingSubmitBtn = document.getElementById("floatingSubmitBtn");
if (floatingSubmitBtn) {
Â  Â  floatingSubmitBtn.addEventListener("click", submitQuiz);
}
// ------------------------------------

renderQuiz();