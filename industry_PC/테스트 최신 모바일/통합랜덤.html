<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>자동차 정비 산업기사 마스터 CBT</title>
    <link rel="stylesheet" href="통합랜덤.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css">
</head>
<body class="light-mode font-medium" id="main-body">

    <nav class="top-nav no-drag">
        <div class="nav-inner">
            <h1 id="main-title" onclick="location.reload()" style="cursor:pointer">자동차 정비 산업기사 CBT</h1>
            <div id="quiz-status-area" class="hidden status-group">
                <span id="timer-display" class="status-badge">60:00</span>
                <span id="progress-display" class="status-badge">
                    <span id="solved-count">0</span> / <span id="total-count">0</span>
                </span>
                <button class="btn-submit-final" onclick="handleFinishSubmit()">시험 제출</button>
            </div>
            <div class="nav-right">
                <button id="theme-btn" class="btn-icon-theme" onclick="toggleTheme()">🌙 다크모드</button>
            </div>
        </div>
    </nav>

    <main class="container">
        <section id="home-screen" class="active-screen">
            
            <div class="settings-panel-slim glass-card no-drag">
                <div class="settings-flex">
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-one-by-one" onchange="toggleViewMode()">
                            <span class="slider"></span><span class="lbl-txt">한문제씩 풀기</span>
                        </label>
                    </div>
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-instant-feedback" onchange="syncInstantMode(this)">
                            <span class="slider"></span><span class="lbl-txt">즉시 채점 해설</span>
                        </label>
                    </div>
                    <div class="setting-item-mini">
                        <label class="st-switch">
                            <input type="checkbox" id="multi-mode-chk" onchange="toggleMultiMode()">
                            <span class="slider"></span><span class="lbl-txt">선택회차 랜덤풀기</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="dashboard glass-card no-drag">
                <div class="stat-container">
                    <div class="stat-info">
                        <div class="stat-pill">최근 점수: <strong id="stat-last">0</strong>점</div>
                        <div class="stat-pill">평균 점수: <strong id="stat-avg">0</strong>점</div>
                    </div>
                    <button class="btn-open-chart" onclick="openStatsModal()">📊 성적 통계 그래프</button>
                </div>
                <div class="main-action-group">
                    <button class="btn-mega-blue" onclick="startExam('full')">🎲 전체 범위 랜덤 풀기 (80문항)</button>
                    <button id="btn-multi-start" class="btn-start-exam hidden" onclick="startExam('multi')">🚀 선택한 회차 80문제 시작</button>
                </div>
            </div>

            <div class="wrong-note-section glass-card no-drag">
                <div class="accordion-trigger" onclick="toggleWrongAccordion()">
                    <span>📕 회차별 오답 기록</span>
                    <span id="wrong-arrow-icon">▼</span>
                </div>
                <div id="wrong-content-area" class="accordion-body hidden">
                    <div class="wrong-header-btns">
                        <button onclick="clearAllWrongs()" class="btn-danger-mini">전체 오답 초기화</button>
                    </div>
                    <div id="wrong-list-display"></div>
                </div>
            </div>

            <div id="round-grid-display" class="round-card-grid no-drag"></div>
        </section>

        <section id="quiz-screen" class="hidden">
            <div class="quiz-quick-settings-fixed no-drag">
                <div class="quick-flex-container">
                    <div class="quick-item" id="auto-scroll-wrap">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-auto-scroll" checked>
                            <span class="slider"></span><span class="lbl-txt">자동 이동</span>
                        </label>
                    </div>
                    <div class="quick-item" id="left-hand-wrap">
                        <label class="st-switch">
                            <input type="checkbox" id="setting-left-hand" onchange="applyLeftHand(this.checked)">
                            <span class="slider"></span><span class="lbl-txt">왼손잡이</span>
                        </label>
                    </div>
                    <div class="quick-item font-control-box">
                        <span class="lbl-txt">글자:</span>
                        <div class="f-btns">
                            <button class="btn-f-size" id="fs-small" onclick="updateFontSize('small')">소</button>
                            <button class="btn-f-size" id="fs-medium" onclick="updateFontSize('medium')">중</button>
                            <button class="btn-f-size" id="fs-large" onclick="updateFontSize('large')">대</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="quiz-main-layout">
                <div class="question-column">
                    <div id="quiz-display-area"></div>
                </div>
                
                <aside id="omr-sidebar" class="omr-column no-drag">
                    <div class="omr-sticky-card glass-card">
                        <div class="omr-header">
                            <h3>OMR 답안지</h3>
                            <span id="omr-status-txt">0 / 0</span>
                        </div>
                        <div class="omr-bulk-marking">
                            <span class="bulk-lbl">미풀이 문제 밀기:</span>
                            <div class="bulk-btns">
                                <button onclick="pushAllAnswers(0)">1</button>
                                <button onclick="pushAllAnswers(1)">2</button>
                                <button onclick="pushAllAnswers(2)">3</button>
                                <button onclick="pushAllAnswers(3)">4</button>
                            </div>
                        </div>
                        <div id="omr-buttons-grid"></div>
                    </div>
                </aside>
            </div>

            <footer class="quiz-bottom-nav no-drag" id="quiz-nav-group">
                <button class="btn-nav-prev" id="btn-move-prev" onclick="moveQuestion(-1)">이전 문제</button>
                <button class="btn-nav-next" id="btn-move-next" onclick="moveQuestion(1)">다음 문제</button>
            </footer>
        </section>

        <section id="result-screen" class="hidden">
            <div class="result-summary-fixed no-drag">
                <div class="res-fixed-inner glass-card">
                    <div class="res-score-line">
                        <strong id="final-result-score" class="score-highlight">0</strong>점
                    </div>
                    <div class="res-action-btns-mini">
                        <button class="btn-res-sm home" onclick="location.reload()">메인</button>
                        <button class="btn-res-sm retry" onclick="retryCurrentExam(false)">전체 다시풀기</button>
                        <button class="btn-res-sm wrong" onclick="retryCurrentExam(true)">오답 다시풀기</button>
                    </div>
                </div>
            </div>
            <div id="review-list-container" class="review-margin-top"></div>
        </section>
    </main>

    <div id="modal-stats-overlay" class="modal-overlay hidden no-drag" onclick="handleOverlayClick(event)">
        <div class="modal-window glass-card" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="stat-chart-title" onclick="handleSecretReset(event)" style="cursor:help">📊 나의 성적 변화 추이</h3>
                <button class="btn-close-modal" onclick="closeStatsModal()">&times;</button>
            </div>
            <div class="chart-wrapper" id="chart-scroll-box">
                <div id="chart-canvas-area"></div>
            </div>
            <p class="chart-desc">가장 우측이 최근 성적입니다.</p>
        </div>
    </div>

    <script src="통합문제.js"></script>
    <script src="통합랜덤.js"></script>
</body>
</html>